distanceMic = 0.05;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
freq = 50000000; %%%%%%%%%%%%%%% LUDICROUSLY HIGH FREQUENCY%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
SecondMicNumber = 3;    %Will be input to function, which further from reference channel is being inputed?
LongerMicDistance = distanceMic*(SecondMicNumber-1);

channelA = [1959;1959;1960;1960;1960;1961;1962;1961;1961;1961;1963;1963;1964;1962;1963;1964;1963;1964;1963;1962;1963;1964;1962;1962;1962;1962;1960;1961;1961;1961;1959;1961;1959;1959;1958;1960;1958;1959;1959;1958;1959;1959;1959;1960;1961;1960;1961;1961;1961;1962;1962;1962;1964;1963;1963;1964;1964;1964;1964;1964;1963;1963;1964;1963;1962;1961;1961;1962;1961;1961;1961;1960;1959;1960;1958;1959;1960;1959;1958;1959;1959;1959;1959;1960;1960;1960;1960;1961;1962;1961;1962;1963;1963;1963;1964;1964;1964;1964;1965;1964;1964;1965;1964;1963;1964;1963;1962;1962;1963;1961;1961;1960;1960;1959;1959;1959;1960;1959;1959;1959;1959;1960;1959;1959;1958;1960;1961;1962;1961;1962;1961;1962;1962;1962;1963;1963;1964;1965;1964;1964;1964;1964;1964;1964;1964;1962;1963;1962;1962;1961;1961;1961;1960;1960;1961;1959;1960;1960;1959;1959;1960;1959;1959;1961;1960;1959;1961;1960;1960;1962;1961;1961;1963;1962;1964;1964;1963;1964;1965;1964;1964;1964;1963;1964;1965;1963;1963;1963;1963;1961;1962;1959;1961;1960;1960;1961;1959;1959;1959;1959;1958;1958;1958;1959;1958;1960;1960;1961;1960;1960;1961;1961;1961;1962;1963;1963;1963;1963;1964;1964;1963;1964;1965;1963;1963;1965;1963;1962;1963;1962;1962;1962;1962;1961;1961;1961;1960;1960;1960;1959;1959;1958;1959;1959;1959;1960;1960;1959;1959;1960;1960;1961;1962;1961;1962]';
channelB = [1907;1907;1907;1908;1908;1907;1908;1909;1909;1910;1909;1910;1910;1910;1909;1910;1911;1910;1911;1911;1911;1909;1910;1911;1910;1909;1909;1908;1909;1907;1908;1907;1907;1907;1907;1907;1907;1906;1907;1908;1907;1907;1907;1907;1909;1907;1908;1910;1908;1909;1910;1910;1910;1911;1911;1911;1911;1911;1910;1911;1912;1910;1910;1910;1910;1909;1909;1910;1909;1909;1908;1908;1908;1908;1908;1907;1906;1907;1907;1906;1908;1908;1907;1908;1908;1909;1909;1908;1909;1909;1910;1910;1910;1910;1910;1910;1911;1911;1911;1911;1911;1910;1911;1911;1910;1910;1910;1910;1910;1909;1908;1908;1909;1909;1909;1908;1907;1907;1906;1907;1906;1906;1908;1907;1908;1908;1907;1908;1909;1909;1909;1910;1910;1911;1910;1911;1910;1910;1912;1911;1911;1912;1910;1911;1911;1910;1910;1911;1909;1910;1910;1909;1909;1908;1907;1909;1907;1907;1908;1907;1907;1908;1907;1907;1908;1907;1908;1908;1909;1908;1909;1909;1909;1910;1909;1909;1912;1911;1910;1911;1911;1911;1912;1910;1911;1912;1910;1911;1911;1909;1909;1910;1908;1909;1908;1907;1908;1906;1906;1906;1908;1907;1906;1907;1906;1907;1907;1907;1908;1908;1908;1909;1909;1909;1910;1910;1910;1911;1910;1910;1912;1911;1910;1912;1911;1910;1911;1910;1910;1911;1909;1910;1909;1908;1909;1908;1907;1908;1907;1906;1907;1907;1906;1906;1907;1907;1908;1907;1907;1908;1909;1908;1909;1909;1909]';
channelC = [1907;1907;1907;1907;1908;1908;1907;1908;1909;1909;1910;1909;1910;1910;1910;1909;1910;1911;1910;1911;1911;1911;1909;1910;1911;1910;1909;1909;1908;1909;1907;1908;1907;1907;1907;1907;1907;1907;1906;1907;1908;1907;1907;1907;1907;1909;1907;1908;1910;1908;1909;1910;1910;1910;1911;1911;1911;1911;1911;1910;1911;1912;1910;1910;1910;1910;1909;1909;1910;1909;1909;1908;1908;1908;1908;1908;1907;1906;1907;1907;1906;1908;1908;1907;1908;1908;1909;1909;1908;1909;1909;1910;1910;1910;1910;1910;1910;1911;1911;1911;1911;1911;1910;1911;1911;1910;1910;1910;1910;1910;1909;1908;1908;1909;1909;1909;1908;1907;1907;1906;1907;1906;1906;1908;1907;1908;1908;1907;1908;1909;1909;1909;1910;1910;1911;1910;1911;1910;1910;1912;1911;1911;1912;1910;1911;1911;1910;1910;1911;1909;1910;1910;1909;1909;1908;1907;1909;1907;1907;1908;1907;1907;1908;1907;1907;1908;1907;1908;1908;1909;1908;1909;1909;1909;1910;1909;1909;1912;1911;1910;1911;1911;1911;1912;1910;1911;1912;1910;1911;1911;1909;1909;1910;1908;1909;1908;1907;1908;1906;1906;1906;1908;1907;1906;1907;1906;1907;1907;1907;1908;1908;1908;1909;1909;1909;1910;1910;1910;1911;1910;1910;1912;1911;1910;1912;1911;1910;1911;1910;1910;1911;1909;1910;1909;1908;1909;1908;1907;1908;1907;1906;1907;1907;1906;1906;1907;1907;1908;1907;1907;1908;1909;1908;1909;1909]';
% 
% 
% x = [0 1 2 3 2 1 0 -1 -2 -3 -2 -1 0 1 2 3 2 1 0 -1 -2 -3 -2 -1 0 1 2 3 2 1 0 -1 -2 -3 -2 -1 0];
% y = [2 3 2 1 0 -1 -2 -3 -2 -1 0 1 2 3 2 1 0 -1 -2 -3 -2 -1 0 1 2 3 2 1 0 -1 -2 -3 -2 -1 0 1 2];

channelA2 = channelA - min(channelA);
channelB2 = channelB - min(channelB);
channelC2 = channelC - min(channelC);

corr = xcorr(channelA2, channelB2);
corr2 = xcorr(channelA2, channelC2);

figure(1)
stem(corr)

figure(2)
stem(corr2)

[m,n] = max(corr);
[o,p] = max(corr2);
%Midway point is at 254.5 or ~255
delta3 = abs(n - 255);
delta4 = abs(p - 255);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
delta = 18.221574; %%%%%%%%%%%%%%%%% THIS IS INPUTING TEST DATA TO ACHIEVE A 20 METER DISTANCE EXACTLY
delta2 = 72.885614;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Rounded to full integers, notice how far from 20m the final distance
%diverges
delta = 18;
delta2 = 73;


t = (delta)/freq;
l = (t*343); %finding the length of the delta length from source
theta = acosd(l/distanceMic);

t2 = (delta2)/freq;
l_2 = (t2*343); %finding the length of the delta length from source
theta2 = acosd(l_2/(LongerMicDistance));

lastTheta = 180-(180-theta)-theta2;

distance = sind(theta2)*distanceMic/sind(lastTheta)


 if p - 255 < 0;
   theta = 180 - theta;
 end

theta   %(degrees)